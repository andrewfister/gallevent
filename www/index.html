{% extends "base.html" %}
{% load map_tags %}

{% block css %}
<link rel="stylesheet" type="text/css" href="/static/css/custom/home-page.css" />
<link rel="stylesheet" type="text/css" href="/static/css/custom/pin-key.css" />
<link rel="stylesheet" type="text/css" href="/static/css/custom/map-pop-ups.css" />
{% endblock %}

{% block prejavascript %}
<script>
var eventsJSON = [ {% for event in events %} {id: {{ event.id }},user_id: {{ event.user_id }},address: "{{ event.address|escapejs }}",subpremise: "{{ event.subpremise|escapejs }}",city: "{{ event.city|escapejs }}",state: "{{ event.state|escapejs }}",zipcode: "{{ event.zipcode|escapejs }}",name: "{{ event.name|escapejs }}",category: "{{ event.category|escapejs }}",ticket_price: {{ event.ticket_price }},start_date: "{{ event.start_date|escapejs }}",end_date: "{{ event.end_date|escapejs }}",description: "{{ event.description|escapejs }}",organizer_email: "{{ event.organizer_email|escapejs }}",organizer_phone: "{{ event.organizer_phone|escapejs }}",organizer_url: "{{ event.organizer_url|escapejs }}",latitude: {{ event.latitude }},longitude: {{ event.longitude }} }, {% endfor %} ];
</script>
{% endblock prejavascript %}

{% block viewjavascript %}
<script type="text/javascript" src="/static/js/views/search-view.js"></script>
{% endblock viewjavascript %}

{% block body-class %}home{% endblock body-class %}

{% block signin-form %}
    {% if user.is_authenticated %}
    <span class="sign-in-status"><a href="{% url 'user_profile.views.show_profile' %}">{{ user.username }}</a>
    <a href="{% url 'login.views.sign_out' %}">Sign Out</a></span>
    {% else %}
    <span class="sign-in-status"><a class="btn-join" href="#">Join Gallevent</a><span class="bar-vertical">|</span><a id="signIn" href="#">Sign In</a></span>
    <div class="hidden">
        <span id="user-id">{{ user.id }}</span>
        <span id="user-username">{{ user.username }}</span>
        <span id="user-firstname">{{ user.firstname }}</span>
        <span id="user-lastname">{{ user.lastname }}</span>
        <span id="user-email">{{ user.email }}</span>
        <span id="user-latitude">{{ request.GET.latitude|default:0 }}</span>
        <span id="user-longitude">{{ request.GET.longitude|default:0 }}</span>
    </div>
    <script>
		$("#signIn").click(function(){
			$(".sign-in-form").slideToggle(600);
		});
	</script>
    <form class="sign-in-form" style="display:none;" method="post">
        <label>Email Address:</label>
        <input type="text" class="input-standard" name="email" />
        <label>Password:</label>
        <input type="password" class="input-standard" name="password" />
        <input type="text" class="hidden" name="next" value="{{ next }}" />
        <button class="btn-sign-in">Sign In</button>
    </form>
    {% endif %}
{% endblock signin-form %}

{% block content %}
<form id="top-search" method="get">
    <label>Search for Events</label>
    <span class="row"><label class="icon find-event" for="event">Search for Events</label>
    <input type="text" id="event" name="q" placeholder="Example: Dancing San Francisco" value="{{ request.GET.q }}" /></span>
    <span class="row"><label class="icon clock" for="time-span">Time</label>
        <span class="select">
            <select id="time-span" name="timeSpan">
                <option value="day_of" {% if timeSpan == "day_of" %}selected="selected"{% endif %}>Day of</option>
                <option value="week_of" {% if timeSpan == "week_of" %}selected="selected"{% endif %}>Week of</option>
                <option value="weekend_of" {% if timeSpan == "weekend_of" %}selected="selected"{% endif %}>Weekend of</option>
            </select>
        </span>
    	<input type="text" id="date" placeholder="{{ form.today.value }}" value="{{ form.start_date.value }}" />
    </span>
    <span class="row">
        <label class="icon price" for="price">Price</label>
        <span class="select">
            <select id="price" name="price">
                <option value="free" {% if timeSpan == "day_of" %}selected="selected"{% endif %}>Free</option>
                <option value="under_10" {% if timeSpan == "week_of" %}selected="selected"{% endif %}>Under $10</option>
                <option value="under_20" {% if timeSpan == "weekend_of" %}selected="selected"{% endif %}>Under $20</option>
            </select>
        </span>
        <button class="btn-search" type="button"><span class="icon-looking-glass">icon</span> Search</button>
    </span>
    
    <input type="hidden" id="map-latitude" name="latitude" value="{{ request.GET.latitude|default:0 }}" />
    <input type="hidden" id="map-longitude" name="longitude" value="{{ request.GET.longitude|default:0 }}" />
    <input type="hidden" id="map-radius" name="distance" value="{{ request.GET.distance|default:5.08 }}" />
    <input type="hidden" id="date1" name="start_date" value=""/>
    <input type="hidden" id="date2" name="end_date" value=""/>
    
</form><!-- #top-nav -->
<ul id="pin-key">
    <li><a href="#" class="key networking"><b>Networking</b><i>Meetups, Mixers, Conferences...</i></a></li>
    <li><a href="#" class="key education"><b>Education</b><i>Classes, Study Groups, Lectures...</i></a></li>
    <li><a href="#" class="key fairs"><b>Fairs &amp; Festivals</b><i>Street, Food, Cultural...</i></a></li>
    <li><a href="#" class="key athletic"><b>Athletic</b><i>Running, biking, hiking...</i></a></li>
    <li><a href="#" class="key art"><b>Art &amp; Music</b><i>Shows, Concerts, Crafting...</i></a></li>
    <li><a href="#" class="key dancing"><b>Dancing</b><i>Classes, Parties, Flash Mobs...</i></a></li>
    <li><a href="#" class="key dining"><b>Dining</b><i>Events for Foodies...</i></a></li>
    <li><a href="#" class="key parties"><b>Nightlife &amp; Parties</b><i>Club, Drinking, Comedy...</i></a></li>
</ul>
<!-- <a class="btn-post-event" href="{% url 'event.views.post_event' %}">Post an Event</a> -->
{% endblock content %}
{% block map %}
	{% show_map %}
{% endblock map %}
